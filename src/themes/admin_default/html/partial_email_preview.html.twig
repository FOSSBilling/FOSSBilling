{#
/**
 * Email Preview Modal JavaScript Partial
 *
 * Provides a reusable function to display email previews in a modal with iframe isolation.
 * This prevents email HTML/CSS from interfering with the admin interface.
 *
 * Automatically sets up event listeners for preview buttons when the DOM is ready.
 * Supported button class: .email-preview-btn
 *
 * Usage:
 *   1. Include this partial in the {% block js %} section of your template
 *   2. Add buttons with class="email-preview-btn" and data attributes:
 *      - data-email-subject: The email subject
 *      - data-email-content: The email HTML content
 *   3. Event listeners are automatically attached on DOMContentLoaded
 */
#}
<script>
/**
 * Show email preview in a modal with iframe for proper HTML isolation
 * @param {string} subject - The email subject
 * @param {string} content - The email HTML content
 */
function showEmailPreview(subject, content) {
    const modalContent = `
        <div class="mb-3">
            <div class="fw-bold text-uppercase text-muted" style="font-size: 0.75rem; letter-spacing: 0.5px; margin-bottom: 0.5rem;">
                {{ "Subject"|trans }}
            </div>
            <div class="p-3" style="background: #f8f9fa; border: 1px dashed #adb5bd; border-radius: 4px; min-height: 50px;">
                ${subject}
            </div>
        </div>
        <div>
            <div class="fw-bold text-uppercase text-muted" style="font-size: 0.75rem; letter-spacing: 0.5px; margin-bottom: 0.5rem;">
                {{ "Message Content"|trans }}
            </div>
            <div style="background: #f8f9fa; border: 1px dashed #adb5bd; border-radius: 4px; overflow: hidden;">
                <iframe
                    style="width: 100%; min-height: 400px; border: none; display: block; background: white;"
                    srcdoc="${content.replace(/"/g, '&quot;')}"
                ></iframe>
            </div>
        </div>
    `;

    Modals.create({
        type: 'default',
        title: '{{ "Email Preview"|trans }}',
        content: modalContent,
        closeButton: '{{ "Close"|trans }}',
        extraClasses: 'modal-lg'
    });
}

// Auto-initialize event listeners for all email preview buttons
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.email-preview-btn').forEach(function(button) {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            const subject = this.dataset.emailSubject;
            const content = this.dataset.emailContent;
            showEmailPreview(subject, content);
        });
    });
});
</script>
