{% extends request.ajax ? "layout_blank.html.twig" : "layout_default.html.twig" %}

{% import "macro_functions.html.twig" as mf %}

{% block meta_title %}{{ 'Contact us'|trans }}{% endblock %}

{% block body_class %}support-contact-us{% endblock %}
{% block breadcrumb %}<li class="breadcrumb-item active" aria-current="page">{{ 'Contact us'|trans }}</li>{% endblock %}
{% block content %}
{% set company = guest.system_company %}
<div class="row">
    <div class="card ml-0 ml-md-3 w-100">
        <div class="card-header">
            <h2>{{ 'Contact us'|trans }}</h2>
            <p>{{ company.signature }}</p>
        </div>
        <div class="card-body">
            <form method="post" action="" id="public-ticket-create" class="form span6">
                <input type="hidden" name="CSRFToken" value="{{ CSRFToken }}"/>
                    <div class="form-group">
                        <label for="name">{{ 'Name'|trans }}: </label>
                        <input class="form-control" type="text" name="name" value="{{request.name}}" required="required" id="name">
                    </div>

                    <div class="form-group">
                        <label for="email">{{ 'Email'|trans }}: </label>
                        <input class="form-control" type="email" name="email" value="{{request.email}}" required="required" id="email">
                    </div>

                    <div class="form-group">
                        <label for="subject">{{ 'Subject'|trans }}: </label>
                        <input class="form-control" type="text" name="subject" value="{{request.subject}}" required="required" id="subject">
                    </div>

                    <div class="form-group">
                        <label for="message">{{ 'Message'|trans }}: </label>
                        <textarea class="form-control" name="message" cols="5" rows="5" required="required" id="message">{{request.message}}</textarea>
                    </div>

                    {{ mf.recaptcha }}
                    <div class="form-group">
                        <button class="btn btn-primary btn-large pull-right" type="submit" value="{{ 'Send'|trans }}" data-loading-text="Loading...">{{ 'Send'|trans }}</button>
                    </div>

                <input type="hidden" name="anti-spam" value="1" id="anti-spam" required="required"/>
            </form>
        </div>
        <div class="card-footer">
            <dl>
                <dd>
                    {{ company.name }}
                </dd>
                <dd>
                    {{ company.address_1 }}
                </dd>
                <dd>
                    {{ company.address_2 }}
                </dd>
                <dd>
                    {{ company.address_3 }}
                </dd>
                <dd>
                    {{ company.tel }}
                </dd>
                <dd>
                    {{ company.www }}
                </dd>
                <dd>
                    {{ company.email }}
                </dd>
            </dl>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
<script>
$(function() {
    $('#anti-spam').remove();

    $('#public-ticket-create').on('submit', function(event) {
        $('.wait').show();
        bb.post(
            'guest/support/ticket_create',
            $(this).serialize(),
            function(result) {
                bb.redirect("{{ 'support/contact-us/conversation'|link }}" + '/' + result);
            }
        );

        return false;
    });
});
</script>
{% endblock %}
