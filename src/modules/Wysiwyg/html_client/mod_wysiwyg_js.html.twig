{{ 'ckeditor.js' | mod_asset_url('wysiwyg') | script_tag }}
{{ 'ckeditor.css' | mod_asset_url('wysiwyg') | stylesheet_tag }}
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
        // Initialize CKEditor on all elements with the specified class
        document.querySelectorAll('.{{ class }}').forEach(function (element) {
            CKEditor.default.create(element)
                .then(editor => {
                    // Handle required attribute - CKEditor manages this internally
                    if (element.hasAttribute('required')) {
                        element.removeAttribute('required');
                    }
                })
                .catch(error => { console.error(error) });
        });

        // Adjust CKEditor text color for dark theme compatibility
        // The editor needs a slight delay to apply styles after initialization
        {% if 'dark' in settings.theme %}
        setTimeout(() => {
            document.querySelectorAll('.ck-editor__main').forEach(function (element) {
                element.style.color="#1d273b";
            });
        }, 1000);
        {% endif %}
    });
</script>
